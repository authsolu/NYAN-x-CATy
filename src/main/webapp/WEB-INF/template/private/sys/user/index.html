#sys_top
#sys_head


<section class="layout">
    #sys_menu
    <!-- 机构  -->
    <aside class="sidebar-250 canvas-right bg-default ">
        <header class="header navbar clearfix bb bg-default pl0 pr0">
            <p class="navbar-text"><i class="fa fa-sitemap mr5"></i> 组织结构</p>
        </header>
        <div class="content-wrap no-p">
            <div class="wrapper">
                <div class="m5">
                    <div id="jsTreeUnit"></div>
                </div>
            </div>
        </div>
    </aside>
    <!-- 列表 -->
    <section class="main-content bg-white">
        <header class="header navbar bg-white shadow">
            #if(${shiro.hasPermission('sys:unit')})
            <div class="btn-group tool-button">
                <a class="btn btn-primary navbar-btn" href="$!basePath/user/add"><i class="ti-plus"></i> 新增用户</a>
                <button class="btn btn-danger navbar-btn" onclick="delCheck()"><i class="ti-close"></i> 删除选中</button>
            </div>
            <div class="pull-right offscreen-right">
                <button class="btn btn-primary navbar-btn" onclick="ns.toggleFilter('.cd-panel')"><i
                        class="fa fa-sliders"></i> 筛选
                </button>
            </div>
            #end
        </header>
        <div class="content-wrap">
            <div class="wrapper" style="min-height:500px;">
                <div class="row">
                    <div class="col-lg-12 table-responsive">
                        <form action="${base}/private/sys/user/list" method="post">
                        <table id="data" class="table no-m">
                            <thead>
                            <tr>
                                <th><input class="icheck" type="checkbox"></th>
                                <th class="col-md-2 pd-l-lg">
                                    <span class="pd-l-sm"></span>用户名
                                </th>
                                <th class="col-md-2">姓名</th>
                                <th class="col-md-2">邮箱</th>
                                <th class="col-md-1">状态</th>
                                <th class="col-md-1">是否在线</th>
                                <th class="col-md-2">操作</th>
                            </tr>
                            </thead>
                            <tbody>

                            </tbody>
                        </table>
                        </form>
                    </div>
                </div>
                #page("data")

            </div>
        </div>
        <a class="exit-offscreen"></a>
    </section>

</section>
<!-- 菜单排序 -->
<div id="dialogSort" class="modal fade bs-modal-sm" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

        </div>
    </div>
</div>


#sys_buttom
<script src="${base}/include/plugins/jquery.nestable.js"></script>
<script src="${base}/include/js/toast.js"></script>
<script src="${base}/include/js/treetable.js"></script>
<script src="${base}/include/js/datatables.js"></script>
<script language="JavaScript">
    var unitTreeTable;
    var selected = [];

    $(document).ready(function () {
        $("#dialogUnitDetail").on("hidden.bs.modal", function () {
            $(this).removeData("bs.modal");
        });
        unitTreeTable = $("#unitTreeTable").treetable({
            expandable: true,
            onNodeExpand: function () {
                var node = this;
                var rows = "<tr data-tt-id=\"loading\" data-tt-parent-id=\"" + node.id + "\" data-tt-branch=\"false\"><td colspan='4'><img src=\"${base}/include/img/loading.gif\"/>loading</td></tr>";
                unitTreeTable.treetable("loadBranch", node, rows);
                $.get("${base}/private/sys/unit/child/" + node.id, {}, function (data) {
                    unitTreeTable.treetable("unloadBranch", node);
                    unitTreeTable.treetable("loadBranch", node, data);
                });
            }
        });

    });

</script>
</body>

</html>
